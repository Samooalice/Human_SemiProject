<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
	PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="mSQL">

 <select id="typeList" parameterType="mVO" resultType="mVO">
		SELECT
    		rno, product_name, product_bank, product_type, join_target
		FROM
    		(
        SELECT
            rownum rno, product_name, product_bank, product_type, join_target
        FROM
            product_info, chat_member
        WHERE
            nickname = #{nickname}
            AND product_type = Interest_type
    		)
		WHERE
    		rno BETWEEN #{startRno} AND #{endRno}	
	</select>
	
	<select id="selTotal" resultType="int">
		SELECT
			COUNT(*)
		FROM
    		(
        SELECT
            rownum rno, product_name, product_bank, product_type, join_target
        FROM
            product_info, chat_member
        WHERE
            nickname = #{nickname}
            AND product_type = Interest_type
    		)
	
	</select>

	
	<!-- 닉네임 총 카운트 가져오기 -->
	<select id="nickCount" resultType="int">
		SELECT
			Count(*) cnt
		FROM
			chat_member
		WHERE	
			nickname=#{nickname}
	</select>
	
	<insert id="addMemb" parameterType="mVO">
		INSERT INTO 
			chat_member(mno, nickname, period_day, birth, gen, main_bank, interest_type)
		VALUES(
			membSeq.NEXTVAL, #{nickname}, #{period_day}, #{birth}, #{gen}, #{main_bank}, #{interest_type}
		)
	</insert>
	
	<update id="editMembInfo" parameterType="mVO">
		UPDATE
			chat_member
		<trim prefix="SET" suffixOverrides=",">
			<if test="period_day != null">
				period_day = #{period_day},
			</if>
			
			<if test="birth != null">
				birth = #{birth},
			</if>
			
			<if test="gen != null">
				gen = #{gen},
			</if>
			<if test="main_bank != null">
				main_bank = #{main_bank},
			</if>
			<if test="interest_type != null">
				interest_type = #{interest_type}
			</if>
		</trim>
		WHERE
			nickname = #{nickname}
	</update>
</mapper>